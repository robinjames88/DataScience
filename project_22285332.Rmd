---
title: "Project_Exploratory Data Analysis"
output: html_document
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 
Reading the data
options(warn=-1)
```{r message=FALSE, warning=FALSE, paged.print=FALSE}
custdata <- read.table('application_train.csv',header=T,sep=',')
```
Data Exploration
Customer Data Summary
```{r}
head(custdata)
```
Customer Data Summary
```{r}
str(custdata)
```
Customer Data Summary

```{r message=FALSE, warning=FALSE, paged.print=FALSE}
summary(custdata)
```

Customer Data Summary

Intial Insights from the basic exploration
* The data had 307511 observation and 122 variables.
* The company had more exposure to cash loan (approximately  9.5 times )than revolving loan.
* More credit customer were offered to female (almost twice(1.92 times)) than man. It would be interesting be explore on this data further more.
*Number of enquiries to Credit Bureau before application to the loan had 41519 in NA's.
*The date of birth data was difficult to understand under curent format.so might need transformation
*The data of the number of children had max value of 19, which is unlikely.
*Has the company accounted for all expenses and deducted all the expense from income?

Visualisation
Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.
```{r GGPLOT - AMOUNT OF INCOME, message=TRUE, warning=FALSE}

ggplot(custdata) + geom_density(aes(x=AMT_INCOME_TOTAL))

```

The density plot is right-skewed distribution has a long right tail. Right-skewed distributions are also called positive-skew distributions. That's because there is a long tail in the positive direction on the number line. The mean is also to the right of the peak.So we need apply some transformation for zooming the data.This graph is tranformed using log scale in next section.

```{r}
ggplot(data = custdata) + stat_count(mapping = aes(x = NAME_EDUCATION_TYPE))
```
This shows clearly show that category, secondary/secondary special is highest, followed by higher education sector category.

```{r}
ggplot(custdata) +
geom_bar(aes(x=NAME_FAMILY_STATUS, fill=NAME_CONTRACT_TYPE),
position="dodge")
```
This helps to categorize the type of loans across each relationship status of customer. For example majority chunk of the cash loans  and revolving loans are taken by married customers.

```{r HORIZONTAL BAR CHART}
ggplot(custdata) +
geom_bar(aes(x=ORGANIZATION_TYPE), fill="gray") +
coord_flip() +
theme(axis.text.y=element_text(size=rel(0.8)))
```


```{r SORTED BAR PLOT}
Org <- table(custdata$ORGANIZATION_TYPE)
ORGF <- as.data.frame(Org)
colnames(ORGF)<-c("ORGANIZATION_TYPE", "count")
summary(ORGF)
ORGF<- transform(ORGF, ORGANIZATION_TYPE=reorder(ORGANIZATION_TYPE, count))
ggplot(ORGF)+
geom_bar(aes(x=ORGANIZATION_TYPE,y=count), stat="identity",
fill="gray") + coord_flip() +
theme(axis.text.y=element_text(size=rel(0.8)))

```
Both bar plot specifies the various organization type the customer works. You can easliy identify the business entity 3 has highest number of customer.This can help in two ways, it helps to identify the strong targets and identify the weak sectors as business oppurtunity.


In banks and financial cross selling and upselling has gained lot of relevance. As the data of excisting customer is already is with institution, this makes easy for institution to give as the already know the credit history of the customer. And the bank have to spend extra money on marketing to gain the extra business. for example the banks can offer extra laon to the customer, or it offer business loans to customer who has bussiness. 
We need to calculate the residual income of the customer known as RINCOME by reducing the total income minus the annuity of the loan amount. RINCOME will show the residual income of the customer after paying loan installment.
```{r echo=TRUE, message=TRUE, warning=TRUE, paged.print=TRUE}
RINCOME<-custdata$AMT_INCOME_TOTAL-custdata$AMT_ANNUITY
ggplot(data = custdata, mapping = aes(x = AMT_INCOME_TOTAL, y = RINCOME,
color = CODE_GENDER)) +
geom_point() +
geom_smooth()
```
Here we can linear relation. And the RINCOME is business oppurtunity to cross sell or even upsell(increasing bank credit amount). Thus incresing the credit exposure of the bank.

Data Transformation

The Date of birth of the customers are given in number of days from 1970-01-01
this needs tranformation to get the age of the customers.
```{r echo=TRUE, message=TRUE, warning=TRUE, paged.print=TRUE}
num_days<-custdata$DAYS_BIRTH
dob<-as.Date(num_days, origin = as.Date("1970/01/01"))
today <- Sys.Date()
d <- difftime(today,dob, units="weeks")
cusAge<-d/52
```



The date is transformed to age.

[1]  74.86264  94.92857 101.19505 101.08242 103.62912  95.41209  86.72253
```{r}

```


The right skewed graph is transformed using log
```{r message=TRUE, warning=TRUE, paged.print=TRUE}
newd<-(log10(custdata$AMT_INCOME_TOTAL)+1)
ggplot(custdata) + geom_density(aes(x=newd))
```

The data is transformed to remove skewness.